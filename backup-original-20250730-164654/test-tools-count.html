<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥å…·æ•°é‡æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        table { border-collapse: collapse; width: 100%; margin: 10px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .tool-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; margin: 20px 0; }
        .tool-card { border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: #f9f9f9; }
        .tool-header { font-weight: bold; color: #333; margin-bottom: 5px; }
        .tool-meta { font-size: 0.9em; color: #666; }
    </style>
</head>
<body>
    <h1>ğŸ” å·¥å…·æ•°é‡å’Œåˆ†ç±»æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>1. æ€»ä½“ç»Ÿè®¡</h2>
        <div id="stats-test">
            <p class="info">æ­£åœ¨åŠ è½½ç»Ÿè®¡æ•°æ®...</p>
        </div>
    </div>

    <div class="test-section">
        <h2>2. åˆ†ç±»ç»Ÿè®¡</h2>
        <div id="category-test">
            <p class="info">æ­£åœ¨åŠ è½½åˆ†ç±»æ•°æ®...</p>
        </div>
    </div>

    <div class="test-section">
        <h2>3. å·¥å…·åˆ—è¡¨</h2>
        <div id="tools-test">
            <p class="info">æ­£åœ¨åŠ è½½å·¥å…·åˆ—è¡¨...</p>
        </div>
    </div>

    <div class="test-section">
        <h2>4. åˆ†ç±»è¿‡æ»¤æµ‹è¯•</h2>
        <div id="filter-test">
            <p class="info">æ­£åœ¨æµ‹è¯•åˆ†ç±»è¿‡æ»¤...</p>
        </div>
    </div>

    <script src="/js/simple-performance.js"></script>
    <script src="/js/fast-loader.js"></script>
    <script>
        async function runTests() {
            try {
                // æµ‹è¯•1: æ€»ä½“ç»Ÿè®¡
                const stats = await window.fastAILoader.getStats();
                document.getElementById('stats-test').innerHTML = `
                    <div class="success">âœ… ç»Ÿè®¡æ•°æ®åŠ è½½æˆåŠŸ</div>
                    <ul>
                        <li><strong>å·¥å…·æ€»æ•°</strong>: ${stats.totalTools}</li>
                        <li><strong>åˆ†ç±»æ€»æ•°</strong>: ${stats.totalCategories}</li>
                        <li><strong>æ¨¡å‹æ€»æ•°</strong>: ${stats.totalModels}</li>
                        <li><strong>Agentæ€»æ•°</strong>: ${stats.totalAgents}</li>
                    </ul>
                `;

                // æµ‹è¯•2: åˆ†ç±»ç»Ÿè®¡
                const categories = await window.fastAILoader.getCategories();
                const categoryStats = Object.entries(categories)
                    .filter(([key, cat]) => cat.count > 0)
                    .map(([key, cat]) => `<tr><td>${cat.icon} ${cat.name}</td><td>${cat.count}</td></tr>`)
                    .join('');
                
                document.getElementById('category-test').innerHTML = `
                    <div class="success">âœ… åˆ†ç±»æ•°æ®åŠ è½½æˆåŠŸ</div>
                    <table>
                        <thead>
                            <tr><th>åˆ†ç±»</th><th>å·¥å…·æ•°é‡</th></tr>
                        </thead>
                        <tbody>
                            ${categoryStats}
                        </tbody>
                    </table>
                `;

                // æµ‹è¯•3: å·¥å…·åˆ—è¡¨
                const allTools = await window.fastAILoader.getTools();
                const toolsHtml = allTools.map(tool => `
                    <div class="tool-card">
                        <div class="tool-header">${tool.logo} ${tool.name}</div>
                        <div class="tool-meta">
                            <div>æä¾›å•†: ${tool.provider}</div>
                            <div>åˆ†ç±»: ${tool.category}</div>
                            <div>è¯„åˆ†: ${tool.rating}/5.0</div>
                            <div>ç”¨æˆ·: ${tool.users}</div>
                            <div>å®šä»·: ${tool.pricing}</div>
                        </div>
                        <div style="margin-top: 10px;">${tool.description}</div>
                    </div>
                `).join('');

                document.getElementById('tools-test').innerHTML = `
                    <div class="success">âœ… å·¥å…·åˆ—è¡¨åŠ è½½æˆåŠŸ (å…±${allTools.length}ä¸ªå·¥å…·)</div>
                    <div class="tool-grid">${toolsHtml}</div>
                `;

                // æµ‹è¯•4: åˆ†ç±»è¿‡æ»¤
                const textTools = await window.fastAILoader.getTools('text-generation');
                const imageTools = await window.fastAILoader.getTools('image-generation');
                const codeTools = await window.fastAILoader.getTools('code-assistant');
                
                document.getElementById('filter-test').innerHTML = `
                    <div class="success">âœ… åˆ†ç±»è¿‡æ»¤æµ‹è¯•æˆåŠŸ</div>
                    <ul>
                        <li><strong>æ–‡æœ¬ç”Ÿæˆå·¥å…·</strong>: ${textTools.length}ä¸ª</li>
                        <li><strong>å›¾åƒç”Ÿæˆå·¥å…·</strong>: ${imageTools.length}ä¸ª</li>
                        <li><strong>ä»£ç åŠ©æ‰‹å·¥å…·</strong>: ${codeTools.length}ä¸ª</li>
                    </ul>
                    <div style="margin-top: 15px;">
                        <h4>æ–‡æœ¬ç”Ÿæˆå·¥å…·åˆ—è¡¨:</h4>
                        <ul>
                            ${textTools.map(tool => `<li>${tool.name} (${tool.provider})</li>`).join('')}
                        </ul>
                    </div>
                `;

            } catch (error) {
                console.error('æµ‹è¯•å¤±è´¥:', error);
                document.body.innerHTML += `
                    <div class="test-section">
                        <h2>âŒ æµ‹è¯•å¤±è´¥</h2>
                        <p class="error">é”™è¯¯ä¿¡æ¯: ${error.message}</p>
                        <pre>${error.stack}</pre>
                    </div>
                `;
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œæµ‹è¯•
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>