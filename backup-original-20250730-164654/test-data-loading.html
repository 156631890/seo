<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®åŠ è½½æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 2rem; }
        .test-section { background: #f8f9fa; padding: 1.5rem; margin: 1rem 0; border-radius: 8px; }
        .test-button { background: #007bff; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 4px; cursor: pointer; margin: 0.5rem; }
        .test-button:hover { background: #0056b3; }
        .status { padding: 0.5rem; margin: 0.5rem 0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .data-display { background: white; padding: 1rem; border-radius: 4px; max-height: 400px; overflow-y: auto; }
        .count { font-weight: bold; color: #007bff; }
    </style>
</head>
<body>
    <h1>ğŸ” æ•°æ®åŠ è½½æµ‹è¯•é¡µé¢</h1>
    
    <div class="test-section">
        <h2>ğŸ“Š æ•°æ®åº“çŠ¶æ€æ£€æŸ¥</h2>
        <div id="database-status"></div>
        <button class="test-button" onclick="checkDatabaseStatus()">æ£€æŸ¥æ•°æ®åº“çŠ¶æ€</button>
        <button class="test-button" onclick="loadFullDatabase()">åŠ è½½å®Œæ•´æ•°æ®åº“</button>
    </div>

    <div class="test-section">
        <h2>ğŸ› ï¸ å·¥å…·æ•°æ®æµ‹è¯•</h2>
        <div id="tools-status"></div>
        <button class="test-button" onclick="testToolsData()">æµ‹è¯•å·¥å…·æ•°æ®</button>
        <div id="tools-display" class="data-display" style="display:none;"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ§  æ¨¡å‹æ•°æ®æµ‹è¯•</h2>
        <div id="models-status"></div>
        <button class="test-button" onclick="testModelsData()">æµ‹è¯•æ¨¡å‹æ•°æ®</button>
        <div id="models-display" class="data-display" style="display:none;"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ¤– Agentæ•°æ®æµ‹è¯•</h2>
        <div id="agents-status"></div>
        <button class="test-button" onclick="testAgentsData()">æµ‹è¯•Agentæ•°æ®</button>
        <div id="agents-display" class="data-display" style="display:none;"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ”„ æ•°æ®åŠ è½½å™¨æµ‹è¯•</h2>
        <div id="loader-status"></div>
        <button class="test-button" onclick="testDataChunks()">æµ‹è¯•æ•°æ®åˆ†å—åŠ è½½å™¨</button>
        <button class="test-button" onclick="testAIToolsLoader()">æµ‹è¯•AIå·¥å…·åŠ è½½å™¨</button>
    </div>

    <!-- å¼•å…¥å¿…è¦çš„è„šæœ¬ -->
    <script src="/js/data-chunks.js"></script>
    <script src="/js/ai-tools-loader.js"></script>
    <script src="/ai-tools-database.js"></script>

    <script>
        // æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
        function checkDatabaseStatus() {
            const statusDiv = document.getElementById('database-status');
            
            if (typeof aiToolsDatabase === 'undefined') {
                statusDiv.innerHTML = '<div class="status error">âŒ aiToolsDatabase æœªåŠ è½½</div>';
                return;
            }

            const tools = aiToolsDatabase.tools || [];
            const models = aiToolsDatabase.models || [];
            const agents = aiToolsDatabase.agents || [];
            const categories = aiToolsDatabase.categories || {};

            statusDiv.innerHTML = `
                <div class="status success">âœ… æ•°æ®åº“å·²åŠ è½½</div>
                <div class="status info">å·¥å…·æ•°é‡: <span class="count">${tools.length}</span></div>
                <div class="status info">æ¨¡å‹æ•°é‡: <span class="count">${models.length}</span></div>
                <div class="status info">Agentæ•°é‡: <span class="count">${agents.length}</span></div>
                <div class="status info">åˆ†ç±»æ•°é‡: <span class="count">${Object.keys(categories).length}</span></div>
            `;
        }

        // åŠ è½½å®Œæ•´æ•°æ®åº“
        function loadFullDatabase() {
            if (typeof aiToolsDatabase === 'undefined') {
                const script = document.createElement('script');
                script.src = '/ai-tools-database.js';
                script.onload = () => {
                    checkDatabaseStatus();
                };
                document.head.appendChild(script);
            } else {
                checkDatabaseStatus();
            }
        }

        // æµ‹è¯•å·¥å…·æ•°æ®
        function testToolsData() {
            const statusDiv = document.getElementById('tools-status');
            const displayDiv = document.getElementById('tools-display');
            
            if (typeof aiToolsDatabase === 'undefined') {
                statusDiv.innerHTML = '<div class="status error">âŒ æ•°æ®åº“æœªåŠ è½½</div>';
                return;
            }

            const tools = aiToolsDatabase.tools || [];
            statusDiv.innerHTML = `<div class="status success">âœ… å·¥å…·æ•°æ®: ${tools.length} ä¸ª</div>`;
            
            displayDiv.style.display = 'block';
            displayDiv.innerHTML = '<h4>å‰10ä¸ªå·¥å…·:</h4>' + 
                tools.slice(0, 10).map(tool => 
                    `<div><strong>${tool.name}</strong> - ${tool.category} - ${tool.description}</div>`
                ).join('');
        }

        // æµ‹è¯•æ¨¡å‹æ•°æ®
        function testModelsData() {
            const statusDiv = document.getElementById('models-status');
            const displayDiv = document.getElementById('models-display');
            
            if (typeof aiToolsDatabase === 'undefined') {
                statusDiv.innerHTML = '<div class="status error">âŒ æ•°æ®åº“æœªåŠ è½½</div>';
                return;
            }

            const models = aiToolsDatabase.models || [];
            statusDiv.innerHTML = `<div class="status success">âœ… æ¨¡å‹æ•°æ®: ${models.length} ä¸ª</div>`;
            
            displayDiv.style.display = 'block';
            displayDiv.innerHTML = '<h4>æ‰€æœ‰æ¨¡å‹:</h4>' + 
                models.map(model => 
                    `<div><strong>${model.name}</strong> - ${model.provider} - ${model.description}</div>`
                ).join('');
        }

        // æµ‹è¯•Agentæ•°æ®
        function testAgentsData() {
            const statusDiv = document.getElementById('agents-status');
            const displayDiv = document.getElementById('agents-display');
            
            if (typeof aiToolsDatabase === 'undefined') {
                statusDiv.innerHTML = '<div class="status error">âŒ æ•°æ®åº“æœªåŠ è½½</div>';
                return;
            }

            const agents = aiToolsDatabase.agents || [];
            statusDiv.innerHTML = `<div class="status success">âœ… Agentæ•°æ®: ${agents.length} ä¸ª</div>`;
            
            displayDiv.style.display = 'block';
            displayDiv.innerHTML = '<h4>æ‰€æœ‰Agent:</h4>' + 
                agents.map(agent => 
                    `<div><strong>${agent.name}</strong> - ${agent.category} - ${agent.description}</div>`
                ).join('');
        }

        // æµ‹è¯•æ•°æ®åˆ†å—åŠ è½½å™¨
        async function testDataChunks() {
            const statusDiv = document.getElementById('loader-status');
            
            if (typeof window.dataChunks === 'undefined') {
                statusDiv.innerHTML = '<div class="status error">âŒ æ•°æ®åˆ†å—åŠ è½½å™¨æœªåŠ è½½</div>';
                return;
            }

            try {
                const tools = await window.dataChunks.getTools();
                const models = await window.dataChunks.getModels();
                const agents = await window.dataChunks.getAgents();

                statusDiv.innerHTML = `
                    <div class="status success">âœ… æ•°æ®åˆ†å—åŠ è½½å™¨æ­£å¸¸</div>
                    <div class="status info">å·¥å…·: ${tools.length} ä¸ª</div>
                    <div class="status info">æ¨¡å‹: ${models.length} ä¸ª</div>
                    <div class="status info">Agent: ${agents.length} ä¸ª</div>
                `;
            } catch (error) {
                statusDiv.innerHTML = `<div class="status error">âŒ æ•°æ®åˆ†å—åŠ è½½å™¨é”™è¯¯: ${error.message}</div>`;
            }
        }

        // æµ‹è¯•AIå·¥å…·åŠ è½½å™¨
        async function testAIToolsLoader() {
            const statusDiv = document.getElementById('loader-status');
            
            if (typeof window.aiToolsLoader === 'undefined') {
                statusDiv.innerHTML = '<div class="status error">âŒ AIå·¥å…·åŠ è½½å™¨æœªåŠ è½½</div>';
                return;
            }

            try {
                const database = await window.aiToolsLoader.getDatabase();
                
                statusDiv.innerHTML = `
                    <div class="status success">âœ… AIå·¥å…·åŠ è½½å™¨æ­£å¸¸</div>
                    <div class="status info">å·¥å…·: ${database.tools ? database.tools.length : 0} ä¸ª</div>
                    <div class="status info">æ¨¡å‹: ${database.models ? database.models.length : 0} ä¸ª</div>
                    <div class="status info">Agent: ${database.agents ? database.agents.length : 0} ä¸ª</div>
                `;
            } catch (error) {
                statusDiv.innerHTML = `<div class="status error">âŒ AIå·¥å…·åŠ è½½å™¨é”™è¯¯: ${error.message}</div>`;
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('load', function() {
            setTimeout(() => {
                checkDatabaseStatus();
            }, 1000);
        });
    </script>
</body>
</html>