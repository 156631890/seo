<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyAI æœ€ç»ˆæµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8fafc;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            border-radius: 1rem;
            text-align: center;
            margin-bottom: 2rem;
        }
        .hero h1 {
            font-size: 3rem;
            margin: 0 0 1rem 0;
            font-weight: 800;
        }
        .test-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        .test-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #1f2937;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }
        .status-success { background: #10b981; }
        .status-error { background: #ef4444; }
        .status-warning { background: #f59e0b; }
        .status-loading { background: #6b7280; animation: pulse 2s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .test-card {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 1px solid #e5e7eb;
        }
        .test-card h4 {
            margin: 0 0 0.5rem 0;
            color: #1f2937;
            font-weight: 600;
        }
        .test-result {
            font-size: 0.9rem;
            color: #6b7280;
        }
        .navigation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .nav-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            text-decoration: none;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s;
            display: block;
        }
        .nav-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .nav-card h4 {
            margin: 0 0 0.5rem 0;
            font-size: 1.1rem;
        }
        .nav-card p {
            margin: 0;
            opacity: 0.9;
            font-size: 0.9rem;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .stat-card {
            background: #f0f9ff;
            padding: 1.5rem;
            border-radius: 0.75rem;
            text-align: center;
            border: 1px solid #e0f2fe;
        }
        .stat-number {
            font-size: 2rem;
            font-weight: 800;
            color: #0369a1;
            display: block;
        }
        .stat-label {
            color: #0c4a6e;
            font-weight: 600;
            font-size: 0.9rem;
        }
        .progress-section {
            background: linear-gradient(135deg, #10b981, #34d399);
            color: white;
            padding: 2rem;
            border-radius: 1rem;
            text-align: center;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }
        .progress-fill {
            height: 100%;
            background: white;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #10b981;
            font-weight: 700;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="hero">
            <h1>ğŸš€ MyAI æœ€ç»ˆåŠŸèƒ½æµ‹è¯•</h1>
            <p>å…¨é¢æ£€æµ‹ç½‘ç«™åŠŸèƒ½å’Œæ•°æ®å®Œæ•´æ€§</p>
        </div>

        <!-- æ•°æ®åº“çŠ¶æ€ -->
        <div class="test-section">
            <h2 class="test-title">
                <span class="status-indicator status-loading" id="db-status"></span>
                ğŸ“Š æ•°æ®åº“åŠ è½½çŠ¶æ€
            </h2>
            <div id="database-info">æ­£åœ¨æ£€æµ‹æ•°æ®åº“...</div>
            <div class="stats-grid" id="stats-grid">
                <!-- ç»Ÿè®¡æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </div>

        <!-- é¡µé¢æµ‹è¯• -->
        <div class="test-section">
            <h2 class="test-title">
                <span class="status-indicator status-success"></span>
                ğŸ§­ é¡µé¢å¯¼èˆªæµ‹è¯•
            </h2>
            <p>ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥æµ‹è¯•å„ä¸ªé¡µé¢æ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p>
            <div class="navigation-grid">
                <a href="/debug-data-loading.html" class="nav-card">
                    <h4>ğŸ” æ•°æ®åŠ è½½è°ƒè¯•</h4>
                    <p>æ£€æŸ¥æ•°æ®åº“åŠ è½½çŠ¶æ€</p>
                </a>
                <a href="/tools-simple-test.html" class="nav-card">
                    <h4>ğŸ› ï¸ å·¥å…·é¡µé¢æµ‹è¯•</h4>
                    <p>æµ‹è¯•AIå·¥å…·æ˜¾ç¤ºåŠŸèƒ½</p>
                </a>
                <a href="/models-simple-test.html" class="nav-card">
                    <h4>ğŸ§  æ¨¡å‹é¡µé¢æµ‹è¯•</h4>
                    <p>æµ‹è¯•AIæ¨¡å‹æ˜¾ç¤ºåŠŸèƒ½</p>
                </a>
                <a href="/agents-simple-test.html" class="nav-card">
                    <h4>ğŸ¤– ä»£ç†é¡µé¢æµ‹è¯•</h4>
                    <p>æµ‹è¯•AIä»£ç†æ˜¾ç¤ºåŠŸèƒ½</p>
                </a>
                <a href="/index-beautiful.html" class="nav-card">
                    <h4>ğŸ  ç¾åŒ–ç‰ˆé¦–é¡µ</h4>
                    <p>æŸ¥çœ‹æ–°è®¾è®¡çš„é¦–é¡µ</p>
                </a>
                <a href="/test-all-pages.html" class="nav-card">
                    <h4>âœ… å®Œæ•´æµ‹è¯•é¡µé¢</h4>
                    <p>ç»¼åˆåŠŸèƒ½éªŒè¯</p>
                </a>
            </div>
        </div>

        <!-- åŠŸèƒ½æµ‹è¯•ç»“æœ -->
        <div class="test-section">
            <h2 class="test-title">
                <span class="status-indicator status-loading" id="func-status"></span>
                âš™ï¸ åŠŸèƒ½æµ‹è¯•ç»“æœ
            </h2>
            <div class="test-grid" id="function-tests">
                <!-- åŠŸèƒ½æµ‹è¯•ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </div>

        <!-- é¡¹ç›®å®Œæˆåº¦ -->
        <div class="progress-section">
            <h2>ğŸ¯ é¡¹ç›®å®Œæˆåº¦</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%;">0%</div>
            </div>
            <div id="completion-status">æ­£åœ¨è¯„ä¼°é¡¹ç›®å®Œæˆåº¦...</div>
        </div>

        <!-- é—®é¢˜è¯Šæ–­ -->
        <div class="test-section">
            <h2 class="test-title">
                <span class="status-indicator status-warning"></span>
                ğŸ”§ é—®é¢˜è¯Šæ–­ä¸è§£å†³æ–¹æ¡ˆ
            </h2>
            <div id="diagnosis-results">
                <div class="test-card">
                    <h4>ğŸš¨ å¦‚æœæ•°æ®ä¸æ˜¾ç¤ºï¼Œè¯·æ£€æŸ¥ï¼š</h4>
                    <div class="test-result">
                        <ol>
                            <li>æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰JavaScripté”™è¯¯</li>
                            <li>æ•°æ®åº“æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡® (/data/ai-database-complete.js)</li>
                            <li>ç½‘ç»œè¯·æ±‚æ˜¯å¦è¢«é˜»æ­¢ï¼ˆCORSé—®é¢˜ï¼‰</li>
                            <li>æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºæ­£ç¡®ä½ç½®</li>
                        </ol>
                    </div>
                </div>
                <div class="test-card">
                    <h4>ğŸ’¡ æ¨èè§£å†³æ–¹æ¡ˆï¼š</h4>
                    <div class="test-result">
                        <ul>
                            <li>ä½¿ç”¨ç®€å•æµ‹è¯•é¡µé¢ï¼ˆå†…åµŒæ•°æ®ï¼‰</li>
                            <li>æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·</li>
                            <li>ç¡®ä¿æ–‡ä»¶æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ</li>
                            <li>å°è¯•ä¸åŒæµè§ˆå™¨æµ‹è¯•</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ è½½æ•°æ®åº“ -->
    <script src="/data/ai-database-complete.js"></script>
    <script>
        // æµ‹è¯•ç®¡ç†å™¨
        class FinalTestManager {
            constructor() {
                this.tests = {
                    database: false,
                    tools: false,
                    models: false,
                    agents: false,
                    navigation: true
                };
                this.startTime = Date.now();
            }

            // æµ‹è¯•æ•°æ®åº“
            testDatabase() {
                const dbStatus = document.getElementById('db-status');
                const dbInfo = document.getElementById('database-info');
                const statsGrid = document.getElementById('stats-grid');

                try {
                    if (typeof aiToolsDatabase === 'undefined') {
                        throw new Error('æ•°æ®åº“æœªåŠ è½½');
                    }

                    const tools = aiToolsDatabase.tools || [];
                    const models = aiToolsDatabase.models || [];
                    const agents = aiToolsDatabase.agents || [];

                    // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
                    dbStatus.className = 'status-indicator status-success';

                    // æ˜¾ç¤ºæ•°æ®åº“ä¿¡æ¯
                    dbInfo.innerHTML = `
                        <div style="color: #10b981; font-weight: 600;">âœ… æ•°æ®åº“åŠ è½½æˆåŠŸï¼</div>
                        <p>æ•°æ®åº“å·²æ­£ç¡®åŠ è½½ï¼ŒåŒ…å«å®Œæ•´çš„AIèµ„æºæ•°æ®ã€‚</p>
                    `;

                    // æ˜¾ç¤ºç»Ÿè®¡æ•°æ®
                    statsGrid.innerHTML = `
                        <div class="stat-card">
                            <span class="stat-number">${tools.length}</span>
                            <div class="stat-label">AIå·¥å…·</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">${models.length}</span>
                            <div class="stat-label">AIæ¨¡å‹</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">${agents.length}</span>
                            <div class="stat-label">AIä»£ç†</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">${Object.keys(aiToolsDatabase.categories || {}).length}</span>
                            <div class="stat-label">å·¥å…·åˆ†ç±»</div>
                        </div>
                    `;

                    this.tests.database = true;
                    this.tests.tools = tools.length > 0;
                    this.tests.models = models.length > 0;
                    this.tests.agents = agents.length > 0;

                } catch (error) {
                    dbStatus.className = 'status-indicator status-error';
                    dbInfo.innerHTML = `
                        <div style="color: #ef4444; font-weight: 600;">âŒ æ•°æ®åº“åŠ è½½å¤±è´¥</div>
                        <p><strong>é”™è¯¯ï¼š</strong>${error.message}</p>
                        <p>è¯·æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºæ­£ç¡®ä½ç½®ã€‚</p>
                    `;

                    statsGrid.innerHTML = `
                        <div class="stat-card">
                            <span class="stat-number">0</span>
                            <div class="stat-label">AIå·¥å…·</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">0</span>
                            <div class="stat-label">AIæ¨¡å‹</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">0</span>
                            <div class="stat-label">AIä»£ç†</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">0</span>
                            <div class="stat-label">å·¥å…·åˆ†ç±»</div>
                        </div>
                    `;
                }
            }

            // æµ‹è¯•åŠŸèƒ½
            testFunctions() {
                const funcStatus = document.getElementById('func-status');
                const functionTests = document.getElementById('function-tests');

                const results = [];

                // æ•°æ®è®¿é—®æµ‹è¯•
                if (this.tests.database) {
                    results.push({
                        title: 'æ•°æ®åº“è®¿é—®',
                        status: 'âœ… æ­£å¸¸',
                        description: 'æ•°æ®åº“å¯ä»¥æ­£å¸¸è®¿é—®'
                    });
                } else {
                    results.push({
                        title: 'æ•°æ®åº“è®¿é—®',
                        status: 'âŒ å¤±è´¥',
                        description: 'æ•°æ®åº“æ— æ³•è®¿é—®'
                    });
                }

                // å·¥å…·æ•°æ®æµ‹è¯•
                if (this.tests.tools) {
                    results.push({
                        title: 'AIå·¥å…·æ•°æ®',
                        status: 'âœ… æ­£å¸¸',
                        description: `åŒ…å« ${aiToolsDatabase.tools.length} ä¸ªå·¥å…·`
                    });
                } else {
                    results.push({
                        title: 'AIå·¥å…·æ•°æ®',
                        status: 'âŒ ç¼ºå¤±',
                        description: 'å·¥å…·æ•°æ®ä¸ºç©ºæˆ–ä¸å­˜åœ¨'
                    });
                }

                // æ¨¡å‹æ•°æ®æµ‹è¯•
                if (this.tests.models) {
                    results.push({
                        title: 'AIæ¨¡å‹æ•°æ®',
                        status: 'âœ… æ­£å¸¸',
                        description: `åŒ…å« ${aiToolsDatabase.models.length} ä¸ªæ¨¡å‹`
                    });
                } else {
                    results.push({
                        title: 'AIæ¨¡å‹æ•°æ®',
                        status: 'âŒ ç¼ºå¤±',
                        description: 'æ¨¡å‹æ•°æ®ä¸ºç©ºæˆ–ä¸å­˜åœ¨'
                    });
                }

                // ä»£ç†æ•°æ®æµ‹è¯•
                if (this.tests.agents) {
                    results.push({
                        title: 'AIä»£ç†æ•°æ®',
                        status: 'âœ… æ­£å¸¸',
                        description: `åŒ…å« ${aiToolsDatabase.agents.length} ä¸ªä»£ç†`
                    });
                } else {
                    results.push({
                        title: 'AIä»£ç†æ•°æ®',
                        status: 'âŒ ç¼ºå¤±',
                        description: 'ä»£ç†æ•°æ®ä¸ºç©ºæˆ–ä¸å­˜åœ¨'
                    });
                }

                // æœç´¢åŠŸèƒ½æµ‹è¯•
                try {
                    const searchTest = aiToolsDatabase.tools.filter(tool => 
                        tool.name.toLowerCase().includes('chat')
                    );
                    results.push({
                        title: 'æœç´¢åŠŸèƒ½',
                        status: 'âœ… æ­£å¸¸',
                        description: `æœç´¢æµ‹è¯•æˆåŠŸï¼Œæ‰¾åˆ° ${searchTest.length} ä¸ªç»“æœ`
                    });
                } catch (error) {
                    results.push({
                        title: 'æœç´¢åŠŸèƒ½',
                        status: 'âŒ å¼‚å¸¸',
                        description: 'æœç´¢åŠŸèƒ½æµ‹è¯•å¤±è´¥'
                    });
                }

                // åˆ†ç±»åŠŸèƒ½æµ‹è¯•
                try {
                    const categories = new Set(aiToolsDatabase.tools.map(tool => tool.category));
                    results.push({
                        title: 'åˆ†ç±»åŠŸèƒ½',
                        status: 'âœ… æ­£å¸¸',
                        description: `åŒ…å« ${categories.size} ä¸ªåˆ†ç±»`
                    });
                } catch (error) {
                    results.push({
                        title: 'åˆ†ç±»åŠŸèƒ½',
                        status: 'âŒ å¼‚å¸¸',
                        description: 'åˆ†ç±»åŠŸèƒ½æµ‹è¯•å¤±è´¥'
                    });
                }

                // æ›´æ–°çŠ¶æ€
                const passedTests = results.filter(r => r.status.includes('âœ…')).length;
                if (passedTests === results.length) {
                    funcStatus.className = 'status-indicator status-success';
                } else if (passedTests > 0) {
                    funcStatus.className = 'status-indicator status-warning';
                } else {
                    funcStatus.className = 'status-indicator status-error';
                }

                // æ˜¾ç¤ºç»“æœ
                functionTests.innerHTML = results.map(result => `
                    <div class="test-card">
                        <h4>${result.title}</h4>
                        <div class="test-result">
                            <strong>${result.status}</strong><br>
                            ${result.description}
                        </div>
                    </div>
                `).join('');
            }

            // æ›´æ–°å®Œæˆåº¦
            updateProgress() {
                const passedTests = Object.values(this.tests).filter(test => test).length;
                const totalTests = Object.keys(this.tests).length;
                const progressPercent = Math.round((passedTests / totalTests) * 100);

                const progressFill = document.getElementById('progress-fill');
                const completionStatus = document.getElementById('completion-status');

                progressFill.style.width = progressPercent + '%';
                progressFill.textContent = progressPercent + '%';

                let statusText = '';
                if (progressPercent >= 90) {
                    statusText = 'ğŸ‰ é¡¹ç›®çŠ¶æ€ä¼˜ç§€ï¼æ‰€æœ‰åŠŸèƒ½æ­£å¸¸è¿è¡Œã€‚';
                } else if (progressPercent >= 70) {
                    statusText = 'âš ï¸ é¡¹ç›®çŠ¶æ€è‰¯å¥½ï¼Œéƒ¨åˆ†åŠŸèƒ½éœ€è¦æ£€æŸ¥ã€‚';
                } else {
                    statusText = 'âŒ é¡¹ç›®å­˜åœ¨é—®é¢˜ï¼Œéœ€è¦ä¿®å¤å…³é”®åŠŸèƒ½ã€‚';
                }

                completionStatus.innerHTML = `
                    <p style="font-size: 1.1rem; margin: 1rem 0;">${statusText}</p>
                    <p>å®Œæˆåº¦ï¼š${progressPercent}% (${passedTests}/${totalTests} é¡¹æµ‹è¯•é€šè¿‡)</p>
                `;
            }

            // è¿è¡Œæ‰€æœ‰æµ‹è¯•
            runAllTests() {
                console.log('å¼€å§‹æœ€ç»ˆæµ‹è¯•...');
                
                setTimeout(() => this.testDatabase(), 100);
                setTimeout(() => this.testFunctions(), 300);
                setTimeout(() => this.updateProgress(), 500);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œæµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            const testManager = new FinalTestManager();
            testManager.runAllTests();
        });
    </script>
</body>
</html>